{
  "version": 3,
  "sources": ["../../echarts/lib/data/helper/createDimensions.js", "../../echarts/lib/model/referHelper.js", "../../echarts/lib/chart/helper/createSeriesData.js", "../../echarts/lib/label/labelGuideHelper.js"],
  "sourcesContent": ["\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\n\r\n/**\r\n * AUTO-GENERATED FILE. DO NOT MODIFY.\r\n */\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\nimport { VISUAL_DIMENSIONS } from '../../util/types.js';\r\nimport SeriesDimensionDefine from '../SeriesDimensionDefine.js';\r\nimport { createHashMap, defaults, each, extend, isObject, isString } from 'zrender/lib/core/util.js';\r\nimport { createSourceFromSeriesDataOption, isSourceInstance } from '../Source.js';\r\nimport { CtorInt32Array } from '../DataStore.js';\r\nimport { normalizeToArray } from '../../util/model.js';\r\nimport { BE_ORDINAL, guessOrdinal } from './sourceHelper.js';\r\nimport { createDimNameMap, ensureSourceDimNameMap, SeriesDataSchema, shouldOmitUnusedDimensions } from './SeriesDataSchema.js';\r\n/**\r\n * For outside usage compat (like echarts-gl are using it).\r\n */\r\nexport function createDimensions(source, opt) {\r\n  return prepareSeriesDataSchema(source, opt).dimensions;\r\n}\r\n/**\r\n * This method builds the relationship between:\r\n * + \"what the coord sys or series requires (see `coordDimensions`)\",\r\n * + \"what the user defines (in `encode` and `dimensions`, see `opt.dimensionsDefine` and `opt.encodeDefine`)\"\r\n * + \"what the data source provids (see `source`)\".\r\n *\r\n * Some guess strategy will be adapted if user does not define something.\r\n * If no 'value' dimension specified, the first no-named dimension will be\r\n * named as 'value'.\r\n *\r\n * @return The results are always sorted by `storeDimIndex` asc.\r\n */\r\nexport default function prepareSeriesDataSchema(\r\n// TODO: TYPE completeDimensions type\r\nsource, opt) {\r\n  if (!isSourceInstance(source)) {\r\n    source = createSourceFromSeriesDataOption(source);\r\n  }\r\n  opt = opt || {};\r\n  var sysDims = opt.coordDimensions || [];\r\n  var dimsDef = opt.dimensionsDefine || source.dimensionsDefine || [];\r\n  var coordDimNameMap = createHashMap();\r\n  var resultList = [];\r\n  var dimCount = getDimCount(source, sysDims, dimsDef, opt.dimensionsCount);\r\n  // Try to ignore unused dimensions if sharing a high dimension datastore\r\n  // 30 is an experience value.\r\n  var omitUnusedDimensions = opt.canOmitUnusedDimensions && shouldOmitUnusedDimensions(dimCount);\r\n  var isUsingSourceDimensionsDef = dimsDef === source.dimensionsDefine;\r\n  var dataDimNameMap = isUsingSourceDimensionsDef ? ensureSourceDimNameMap(source) : createDimNameMap(dimsDef);\r\n  var encodeDef = opt.encodeDefine;\r\n  if (!encodeDef && opt.encodeDefaulter) {\r\n    encodeDef = opt.encodeDefaulter(source, dimCount);\r\n  }\r\n  var encodeDefMap = createHashMap(encodeDef);\r\n  var indicesMap = new CtorInt32Array(dimCount);\r\n  for (var i = 0; i < indicesMap.length; i++) {\r\n    indicesMap[i] = -1;\r\n  }\r\n  function getResultItem(dimIdx) {\r\n    var idx = indicesMap[dimIdx];\r\n    if (idx < 0) {\r\n      var dimDefItemRaw = dimsDef[dimIdx];\r\n      var dimDefItem = isObject(dimDefItemRaw) ? dimDefItemRaw : {\r\n        name: dimDefItemRaw\r\n      };\r\n      var resultItem = new SeriesDimensionDefine();\r\n      var userDimName = dimDefItem.name;\r\n      if (userDimName != null && dataDimNameMap.get(userDimName) != null) {\r\n        // Only if `series.dimensions` is defined in option\r\n        // displayName, will be set, and dimension will be displayed vertically in\r\n        // tooltip by default.\r\n        resultItem.name = resultItem.displayName = userDimName;\r\n      }\r\n      dimDefItem.type != null && (resultItem.type = dimDefItem.type);\r\n      dimDefItem.displayName != null && (resultItem.displayName = dimDefItem.displayName);\r\n      var newIdx = resultList.length;\r\n      indicesMap[dimIdx] = newIdx;\r\n      resultItem.storeDimIndex = dimIdx;\r\n      resultList.push(resultItem);\r\n      return resultItem;\r\n    }\r\n    return resultList[idx];\r\n  }\r\n  if (!omitUnusedDimensions) {\r\n    for (var i = 0; i < dimCount; i++) {\r\n      getResultItem(i);\r\n    }\r\n  }\r\n  // Set `coordDim` and `coordDimIndex` by `encodeDefMap` and normalize `encodeDefMap`.\r\n  encodeDefMap.each(function (dataDimsRaw, coordDim) {\r\n    var dataDims = normalizeToArray(dataDimsRaw).slice();\r\n    // Note: It is allowed that `dataDims.length` is `0`, e.g., options is\r\n    // `{encode: {x: -1, y: 1}}`. Should not filter anything in\r\n    // this case.\r\n    if (dataDims.length === 1 && !isString(dataDims[0]) && dataDims[0] < 0) {\r\n      encodeDefMap.set(coordDim, false);\r\n      return;\r\n    }\r\n    var validDataDims = encodeDefMap.set(coordDim, []);\r\n    each(dataDims, function (resultDimIdxOrName, idx) {\r\n      // The input resultDimIdx can be dim name or index.\r\n      var resultDimIdx = isString(resultDimIdxOrName) ? dataDimNameMap.get(resultDimIdxOrName) : resultDimIdxOrName;\r\n      if (resultDimIdx != null && resultDimIdx < dimCount) {\r\n        validDataDims[idx] = resultDimIdx;\r\n        applyDim(getResultItem(resultDimIdx), coordDim, idx);\r\n      }\r\n    });\r\n  });\r\n  // Apply templates and default order from `sysDims`.\r\n  var availDimIdx = 0;\r\n  each(sysDims, function (sysDimItemRaw) {\r\n    var coordDim;\r\n    var sysDimItemDimsDef;\r\n    var sysDimItemOtherDims;\r\n    var sysDimItem;\r\n    if (isString(sysDimItemRaw)) {\r\n      coordDim = sysDimItemRaw;\r\n      sysDimItem = {};\r\n    } else {\r\n      sysDimItem = sysDimItemRaw;\r\n      coordDim = sysDimItem.name;\r\n      var ordinalMeta = sysDimItem.ordinalMeta;\r\n      sysDimItem.ordinalMeta = null;\r\n      sysDimItem = extend({}, sysDimItem);\r\n      sysDimItem.ordinalMeta = ordinalMeta;\r\n      // `coordDimIndex` should not be set directly.\r\n      sysDimItemDimsDef = sysDimItem.dimsDef;\r\n      sysDimItemOtherDims = sysDimItem.otherDims;\r\n      sysDimItem.name = sysDimItem.coordDim = sysDimItem.coordDimIndex = sysDimItem.dimsDef = sysDimItem.otherDims = null;\r\n    }\r\n    var dataDims = encodeDefMap.get(coordDim);\r\n    // negative resultDimIdx means no need to mapping.\r\n    if (dataDims === false) {\r\n      return;\r\n    }\r\n    dataDims = normalizeToArray(dataDims);\r\n    // dimensions provides default dim sequences.\r\n    if (!dataDims.length) {\r\n      for (var i = 0; i < (sysDimItemDimsDef && sysDimItemDimsDef.length || 1); i++) {\r\n        while (availDimIdx < dimCount && getResultItem(availDimIdx).coordDim != null) {\r\n          availDimIdx++;\r\n        }\r\n        availDimIdx < dimCount && dataDims.push(availDimIdx++);\r\n      }\r\n    }\r\n    // Apply templates.\r\n    each(dataDims, function (resultDimIdx, coordDimIndex) {\r\n      var resultItem = getResultItem(resultDimIdx);\r\n      // Coordinate system has a higher priority on dim type than source.\r\n      if (isUsingSourceDimensionsDef && sysDimItem.type != null) {\r\n        resultItem.type = sysDimItem.type;\r\n      }\r\n      applyDim(defaults(resultItem, sysDimItem), coordDim, coordDimIndex);\r\n      if (resultItem.name == null && sysDimItemDimsDef) {\r\n        var sysDimItemDimsDefItem = sysDimItemDimsDef[coordDimIndex];\r\n        !isObject(sysDimItemDimsDefItem) && (sysDimItemDimsDefItem = {\r\n          name: sysDimItemDimsDefItem\r\n        });\r\n        resultItem.name = resultItem.displayName = sysDimItemDimsDefItem.name;\r\n        resultItem.defaultTooltip = sysDimItemDimsDefItem.defaultTooltip;\r\n      }\r\n      // FIXME refactor, currently only used in case: {otherDims: {tooltip: false}}\r\n      sysDimItemOtherDims && defaults(resultItem.otherDims, sysDimItemOtherDims);\r\n    });\r\n  });\r\n  function applyDim(resultItem, coordDim, coordDimIndex) {\r\n    if (VISUAL_DIMENSIONS.get(coordDim) != null) {\r\n      resultItem.otherDims[coordDim] = coordDimIndex;\r\n    } else {\r\n      resultItem.coordDim = coordDim;\r\n      resultItem.coordDimIndex = coordDimIndex;\r\n      coordDimNameMap.set(coordDim, true);\r\n    }\r\n  }\r\n  // Make sure the first extra dim is 'value'.\r\n  var generateCoord = opt.generateCoord;\r\n  var generateCoordCount = opt.generateCoordCount;\r\n  var fromZero = generateCoordCount != null;\r\n  generateCoordCount = generateCoord ? generateCoordCount || 1 : 0;\r\n  var extra = generateCoord || 'value';\r\n  function ifNoNameFillWithCoordName(resultItem) {\r\n    if (resultItem.name == null) {\r\n      // Duplication will be removed in the next step.\r\n      resultItem.name = resultItem.coordDim;\r\n    }\r\n  }\r\n  // Set dim `name` and other `coordDim` and other props.\r\n  if (!omitUnusedDimensions) {\r\n    for (var resultDimIdx = 0; resultDimIdx < dimCount; resultDimIdx++) {\r\n      var resultItem = getResultItem(resultDimIdx);\r\n      var coordDim = resultItem.coordDim;\r\n      if (coordDim == null) {\r\n        // TODO no need to generate coordDim for isExtraCoord?\r\n        resultItem.coordDim = genCoordDimName(extra, coordDimNameMap, fromZero);\r\n        resultItem.coordDimIndex = 0;\r\n        // Series specified generateCoord is using out.\r\n        if (!generateCoord || generateCoordCount <= 0) {\r\n          resultItem.isExtraCoord = true;\r\n        }\r\n        generateCoordCount--;\r\n      }\r\n      ifNoNameFillWithCoordName(resultItem);\r\n      if (resultItem.type == null && (guessOrdinal(source, resultDimIdx) === BE_ORDINAL.Must\r\n      // Consider the case:\r\n      // {\r\n      //    dataset: {source: [\r\n      //        ['2001', 123],\r\n      //        ['2002', 456],\r\n      //        ...\r\n      //        ['The others', 987],\r\n      //    ]},\r\n      //    series: {type: 'pie'}\r\n      // }\r\n      // The first column should better be treated as a \"ordinal\" although it\r\n      // might not be detected as an \"ordinal\" by `guessOrdinal`.\r\n      || resultItem.isExtraCoord && (resultItem.otherDims.itemName != null || resultItem.otherDims.seriesName != null))) {\r\n        resultItem.type = 'ordinal';\r\n      }\r\n    }\r\n  } else {\r\n    each(resultList, function (resultItem) {\r\n      // PENDING: guessOrdinal or let user specify type: 'ordinal' manually?\r\n      ifNoNameFillWithCoordName(resultItem);\r\n    });\r\n    // Sort dimensions: there are some rule that use the last dim as label,\r\n    // and for some latter travel process easier.\r\n    resultList.sort(function (item0, item1) {\r\n      return item0.storeDimIndex - item1.storeDimIndex;\r\n    });\r\n  }\r\n  removeDuplication(resultList);\r\n  return new SeriesDataSchema({\r\n    source: source,\r\n    dimensions: resultList,\r\n    fullDimensionCount: dimCount,\r\n    dimensionOmitted: omitUnusedDimensions\r\n  });\r\n}\r\nfunction removeDuplication(result) {\r\n  var duplicationMap = createHashMap();\r\n  for (var i = 0; i < result.length; i++) {\r\n    var dim = result[i];\r\n    var dimOriginalName = dim.name;\r\n    var count = duplicationMap.get(dimOriginalName) || 0;\r\n    if (count > 0) {\r\n      // Starts from 0.\r\n      dim.name = dimOriginalName + (count - 1);\r\n    }\r\n    count++;\r\n    duplicationMap.set(dimOriginalName, count);\r\n  }\r\n}\r\n// ??? TODO\r\n// Originally detect dimCount by data[0]. Should we\r\n// optimize it to only by sysDims and dimensions and encode.\r\n// So only necessary dims will be initialized.\r\n// But\r\n// (1) custom series should be considered. where other dims\r\n// may be visited.\r\n// (2) sometimes user need to calculate bubble size or use visualMap\r\n// on other dimensions besides coordSys needed.\r\n// So, dims that is not used by system, should be shared in data store?\r\nfunction getDimCount(source, sysDims, dimsDef, optDimCount) {\r\n  // Note that the result dimCount should not small than columns count\r\n  // of data, otherwise `dataDimNameMap` checking will be incorrect.\r\n  var dimCount = Math.max(source.dimensionsDetectedCount || 1, sysDims.length, dimsDef.length, optDimCount || 0);\r\n  each(sysDims, function (sysDimItem) {\r\n    var sysDimItemDimsDef;\r\n    if (isObject(sysDimItem) && (sysDimItemDimsDef = sysDimItem.dimsDef)) {\r\n      dimCount = Math.max(dimCount, sysDimItemDimsDef.length);\r\n    }\r\n  });\r\n  return dimCount;\r\n}\r\nfunction genCoordDimName(name, map, fromZero) {\r\n  if (fromZero || map.hasKey(name)) {\r\n    var i = 0;\r\n    while (map.hasKey(name + i)) {\r\n      i++;\r\n    }\r\n    name += i;\r\n  }\r\n  map.set(name, true);\r\n  return name;\r\n}", "\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\n\r\n/**\r\n * AUTO-GENERATED FILE. DO NOT MODIFY.\r\n */\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n/**\r\n * Helper for model references.\r\n * There are many manners to refer axis/coordSys.\r\n */\r\n// TODO\r\n// merge relevant logic to this file?\r\n// check: \"modelHelper\" of tooltip and \"BrushTargetManager\".\r\nimport { createHashMap, retrieve, each } from 'zrender/lib/core/util.js';\r\nimport { SINGLE_REFERRING } from '../util/model.js';\r\n/**\r\n * @class\r\n * For example:\r\n * {\r\n *     coordSysName: 'cartesian2d',\r\n *     coordSysDims: ['x', 'y', ...],\r\n *     axisMap: HashMap({\r\n *         x: xAxisModel,\r\n *         y: yAxisModel\r\n *     }),\r\n *     categoryAxisMap: HashMap({\r\n *         x: xAxisModel,\r\n *         y: undefined\r\n *     }),\r\n *     // The index of the first category axis in `coordSysDims`.\r\n *     // `null/undefined` means no category axis exists.\r\n *     firstCategoryDimIndex: 1,\r\n *     // To replace user specified encode.\r\n * }\r\n */\r\nvar CoordSysInfo = /** @class */function () {\r\n  function CoordSysInfo(coordSysName) {\r\n    this.coordSysDims = [];\r\n    this.axisMap = createHashMap();\r\n    this.categoryAxisMap = createHashMap();\r\n    this.coordSysName = coordSysName;\r\n  }\r\n  return CoordSysInfo;\r\n}();\r\nexport function getCoordSysInfoBySeries(seriesModel) {\r\n  var coordSysName = seriesModel.get('coordinateSystem');\r\n  var result = new CoordSysInfo(coordSysName);\r\n  var fetch = fetchers[coordSysName];\r\n  if (fetch) {\r\n    fetch(seriesModel, result, result.axisMap, result.categoryAxisMap);\r\n    return result;\r\n  }\r\n}\r\nvar fetchers = {\r\n  cartesian2d: function (seriesModel, result, axisMap, categoryAxisMap) {\r\n    var xAxisModel = seriesModel.getReferringComponents('xAxis', SINGLE_REFERRING).models[0];\r\n    var yAxisModel = seriesModel.getReferringComponents('yAxis', SINGLE_REFERRING).models[0];\r\n    if (process.env.NODE_ENV !== 'production') {\r\n      if (!xAxisModel) {\r\n        throw new Error('xAxis \"' + retrieve(seriesModel.get('xAxisIndex'), seriesModel.get('xAxisId'), 0) + '\" not found');\r\n      }\r\n      if (!yAxisModel) {\r\n        throw new Error('yAxis \"' + retrieve(seriesModel.get('xAxisIndex'), seriesModel.get('yAxisId'), 0) + '\" not found');\r\n      }\r\n    }\r\n    result.coordSysDims = ['x', 'y'];\r\n    axisMap.set('x', xAxisModel);\r\n    axisMap.set('y', yAxisModel);\r\n    if (isCategory(xAxisModel)) {\r\n      categoryAxisMap.set('x', xAxisModel);\r\n      result.firstCategoryDimIndex = 0;\r\n    }\r\n    if (isCategory(yAxisModel)) {\r\n      categoryAxisMap.set('y', yAxisModel);\r\n      result.firstCategoryDimIndex == null && (result.firstCategoryDimIndex = 1);\r\n    }\r\n  },\r\n  singleAxis: function (seriesModel, result, axisMap, categoryAxisMap) {\r\n    var singleAxisModel = seriesModel.getReferringComponents('singleAxis', SINGLE_REFERRING).models[0];\r\n    if (process.env.NODE_ENV !== 'production') {\r\n      if (!singleAxisModel) {\r\n        throw new Error('singleAxis should be specified.');\r\n      }\r\n    }\r\n    result.coordSysDims = ['single'];\r\n    axisMap.set('single', singleAxisModel);\r\n    if (isCategory(singleAxisModel)) {\r\n      categoryAxisMap.set('single', singleAxisModel);\r\n      result.firstCategoryDimIndex = 0;\r\n    }\r\n  },\r\n  polar: function (seriesModel, result, axisMap, categoryAxisMap) {\r\n    var polarModel = seriesModel.getReferringComponents('polar', SINGLE_REFERRING).models[0];\r\n    var radiusAxisModel = polarModel.findAxisModel('radiusAxis');\r\n    var angleAxisModel = polarModel.findAxisModel('angleAxis');\r\n    if (process.env.NODE_ENV !== 'production') {\r\n      if (!angleAxisModel) {\r\n        throw new Error('angleAxis option not found');\r\n      }\r\n      if (!radiusAxisModel) {\r\n        throw new Error('radiusAxis option not found');\r\n      }\r\n    }\r\n    result.coordSysDims = ['radius', 'angle'];\r\n    axisMap.set('radius', radiusAxisModel);\r\n    axisMap.set('angle', angleAxisModel);\r\n    if (isCategory(radiusAxisModel)) {\r\n      categoryAxisMap.set('radius', radiusAxisModel);\r\n      result.firstCategoryDimIndex = 0;\r\n    }\r\n    if (isCategory(angleAxisModel)) {\r\n      categoryAxisMap.set('angle', angleAxisModel);\r\n      result.firstCategoryDimIndex == null && (result.firstCategoryDimIndex = 1);\r\n    }\r\n  },\r\n  geo: function (seriesModel, result, axisMap, categoryAxisMap) {\r\n    result.coordSysDims = ['lng', 'lat'];\r\n  },\r\n  parallel: function (seriesModel, result, axisMap, categoryAxisMap) {\r\n    var ecModel = seriesModel.ecModel;\r\n    var parallelModel = ecModel.getComponent('parallel', seriesModel.get('parallelIndex'));\r\n    var coordSysDims = result.coordSysDims = parallelModel.dimensions.slice();\r\n    each(parallelModel.parallelAxisIndex, function (axisIndex, index) {\r\n      var axisModel = ecModel.getComponent('parallelAxis', axisIndex);\r\n      var axisDim = coordSysDims[index];\r\n      axisMap.set(axisDim, axisModel);\r\n      if (isCategory(axisModel)) {\r\n        categoryAxisMap.set(axisDim, axisModel);\r\n        if (result.firstCategoryDimIndex == null) {\r\n          result.firstCategoryDimIndex = index;\r\n        }\r\n      }\r\n    });\r\n  }\r\n};\r\nfunction isCategory(axisModel) {\r\n  return axisModel.get('type') === 'category';\r\n}", "\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\n\r\n/**\r\n * AUTO-GENERATED FILE. DO NOT MODIFY.\r\n */\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\nimport * as zrUtil from 'zrender/lib/core/util.js';\r\nimport SeriesData from '../../data/SeriesData.js';\r\nimport prepareSeriesDataSchema from '../../data/helper/createDimensions.js';\r\nimport { getDimensionTypeByAxis } from '../../data/helper/dimensionHelper.js';\r\nimport { getDataItemValue } from '../../util/model.js';\r\nimport CoordinateSystem from '../../core/CoordinateSystem.js';\r\nimport { getCoordSysInfoBySeries } from '../../model/referHelper.js';\r\nimport { createSourceFromSeriesDataOption } from '../../data/Source.js';\r\nimport { enableDataStack } from '../../data/helper/dataStackHelper.js';\r\nimport { makeSeriesEncodeForAxisCoordSys } from '../../data/helper/sourceHelper.js';\r\nimport { SOURCE_FORMAT_ORIGINAL } from '../../util/types.js';\r\nfunction getCoordSysDimDefs(seriesModel, coordSysInfo) {\r\n  var coordSysName = seriesModel.get('coordinateSystem');\r\n  var registeredCoordSys = CoordinateSystem.get(coordSysName);\r\n  var coordSysDimDefs;\r\n  if (coordSysInfo && coordSysInfo.coordSysDims) {\r\n    coordSysDimDefs = zrUtil.map(coordSysInfo.coordSysDims, function (dim) {\r\n      var dimInfo = {\r\n        name: dim\r\n      };\r\n      var axisModel = coordSysInfo.axisMap.get(dim);\r\n      if (axisModel) {\r\n        var axisType = axisModel.get('type');\r\n        dimInfo.type = getDimensionTypeByAxis(axisType);\r\n      }\r\n      return dimInfo;\r\n    });\r\n  }\r\n  if (!coordSysDimDefs) {\r\n    // Get dimensions from registered coordinate system\r\n    coordSysDimDefs = registeredCoordSys && (registeredCoordSys.getDimensionsInfo ? registeredCoordSys.getDimensionsInfo() : registeredCoordSys.dimensions.slice()) || ['x', 'y'];\r\n  }\r\n  return coordSysDimDefs;\r\n}\r\nfunction injectOrdinalMeta(dimInfoList, createInvertedIndices, coordSysInfo) {\r\n  var firstCategoryDimIndex;\r\n  var hasNameEncode;\r\n  coordSysInfo && zrUtil.each(dimInfoList, function (dimInfo, dimIndex) {\r\n    var coordDim = dimInfo.coordDim;\r\n    var categoryAxisModel = coordSysInfo.categoryAxisMap.get(coordDim);\r\n    if (categoryAxisModel) {\r\n      if (firstCategoryDimIndex == null) {\r\n        firstCategoryDimIndex = dimIndex;\r\n      }\r\n      dimInfo.ordinalMeta = categoryAxisModel.getOrdinalMeta();\r\n      if (createInvertedIndices) {\r\n        dimInfo.createInvertedIndices = true;\r\n      }\r\n    }\r\n    if (dimInfo.otherDims.itemName != null) {\r\n      hasNameEncode = true;\r\n    }\r\n  });\r\n  if (!hasNameEncode && firstCategoryDimIndex != null) {\r\n    dimInfoList[firstCategoryDimIndex].otherDims.itemName = 0;\r\n  }\r\n  return firstCategoryDimIndex;\r\n}\r\n/**\r\n * Caution: there are side effects to `sourceManager` in this method.\r\n * Should better only be called in `Series['getInitialData']`.\r\n */\r\nfunction createSeriesData(sourceRaw, seriesModel, opt) {\r\n  opt = opt || {};\r\n  var sourceManager = seriesModel.getSourceManager();\r\n  var source;\r\n  var isOriginalSource = false;\r\n  if (sourceRaw) {\r\n    isOriginalSource = true;\r\n    source = createSourceFromSeriesDataOption(sourceRaw);\r\n  } else {\r\n    source = sourceManager.getSource();\r\n    // Is series.data. not dataset.\r\n    isOriginalSource = source.sourceFormat === SOURCE_FORMAT_ORIGINAL;\r\n  }\r\n  var coordSysInfo = getCoordSysInfoBySeries(seriesModel);\r\n  var coordSysDimDefs = getCoordSysDimDefs(seriesModel, coordSysInfo);\r\n  var useEncodeDefaulter = opt.useEncodeDefaulter;\r\n  var encodeDefaulter = zrUtil.isFunction(useEncodeDefaulter) ? useEncodeDefaulter : useEncodeDefaulter ? zrUtil.curry(makeSeriesEncodeForAxisCoordSys, coordSysDimDefs, seriesModel) : null;\r\n  var createDimensionOptions = {\r\n    coordDimensions: coordSysDimDefs,\r\n    generateCoord: opt.generateCoord,\r\n    encodeDefine: seriesModel.getEncode(),\r\n    encodeDefaulter: encodeDefaulter,\r\n    canOmitUnusedDimensions: !isOriginalSource\r\n  };\r\n  var schema = prepareSeriesDataSchema(source, createDimensionOptions);\r\n  var firstCategoryDimIndex = injectOrdinalMeta(schema.dimensions, opt.createInvertedIndices, coordSysInfo);\r\n  var store = !isOriginalSource ? sourceManager.getSharedDataStore(schema) : null;\r\n  var stackCalculationInfo = enableDataStack(seriesModel, {\r\n    schema: schema,\r\n    store: store\r\n  });\r\n  var data = new SeriesData(schema, seriesModel);\r\n  data.setCalculationInfo(stackCalculationInfo);\r\n  var dimValueGetter = firstCategoryDimIndex != null && isNeedCompleteOrdinalData(source) ? function (itemOpt, dimName, dataIndex, dimIndex) {\r\n    // Use dataIndex as ordinal value in categoryAxis\r\n    return dimIndex === firstCategoryDimIndex ? dataIndex : this.defaultDimValueGetter(itemOpt, dimName, dataIndex, dimIndex);\r\n  } : null;\r\n  data.hasItemOption = false;\r\n  data.initData(\r\n  // Try to reuse the data store in sourceManager if using dataset.\r\n  isOriginalSource ? source : store, null, dimValueGetter);\r\n  return data;\r\n}\r\nfunction isNeedCompleteOrdinalData(source) {\r\n  if (source.sourceFormat === SOURCE_FORMAT_ORIGINAL) {\r\n    var sampleItem = firstDataNotNull(source.data || []);\r\n    return !zrUtil.isArray(getDataItemValue(sampleItem));\r\n  }\r\n}\r\nfunction firstDataNotNull(arr) {\r\n  var i = 0;\r\n  while (i < arr.length && arr[i] == null) {\r\n    i++;\r\n  }\r\n  return arr[i];\r\n}\r\nexport default createSeriesData;", "\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\n\r\n\r\n/**\r\n * AUTO-GENERATED FILE. DO NOT MODIFY.\r\n */\r\n\r\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\r\nimport { Point, Path, Polyline } from '../util/graphic.js';\r\nimport PathProxy from 'zrender/lib/core/PathProxy.js';\r\nimport { normalizeRadian } from 'zrender/lib/contain/util.js';\r\nimport { cubicProjectPoint, quadraticProjectPoint } from 'zrender/lib/core/curve.js';\r\nimport { defaults, retrieve2 } from 'zrender/lib/core/util.js';\r\nimport { invert } from 'zrender/lib/core/matrix.js';\r\nimport * as vector from 'zrender/lib/core/vector.js';\r\nimport { DISPLAY_STATES, SPECIAL_STATES } from '../util/states.js';\r\nvar PI2 = Math.PI * 2;\r\nvar CMD = PathProxy.CMD;\r\nvar DEFAULT_SEARCH_SPACE = ['top', 'right', 'bottom', 'left'];\r\nfunction getCandidateAnchor(pos, distance, rect, outPt, outDir) {\r\n  var width = rect.width;\r\n  var height = rect.height;\r\n  switch (pos) {\r\n    case 'top':\r\n      outPt.set(rect.x + width / 2, rect.y - distance);\r\n      outDir.set(0, -1);\r\n      break;\r\n    case 'bottom':\r\n      outPt.set(rect.x + width / 2, rect.y + height + distance);\r\n      outDir.set(0, 1);\r\n      break;\r\n    case 'left':\r\n      outPt.set(rect.x - distance, rect.y + height / 2);\r\n      outDir.set(-1, 0);\r\n      break;\r\n    case 'right':\r\n      outPt.set(rect.x + width + distance, rect.y + height / 2);\r\n      outDir.set(1, 0);\r\n      break;\r\n  }\r\n}\r\nfunction projectPointToArc(cx, cy, r, startAngle, endAngle, anticlockwise, x, y, out) {\r\n  x -= cx;\r\n  y -= cy;\r\n  var d = Math.sqrt(x * x + y * y);\r\n  x /= d;\r\n  y /= d;\r\n  // Intersect point.\r\n  var ox = x * r + cx;\r\n  var oy = y * r + cy;\r\n  if (Math.abs(startAngle - endAngle) % PI2 < 1e-4) {\r\n    // Is a circle\r\n    out[0] = ox;\r\n    out[1] = oy;\r\n    return d - r;\r\n  }\r\n  if (anticlockwise) {\r\n    var tmp = startAngle;\r\n    startAngle = normalizeRadian(endAngle);\r\n    endAngle = normalizeRadian(tmp);\r\n  } else {\r\n    startAngle = normalizeRadian(startAngle);\r\n    endAngle = normalizeRadian(endAngle);\r\n  }\r\n  if (startAngle > endAngle) {\r\n    endAngle += PI2;\r\n  }\r\n  var angle = Math.atan2(y, x);\r\n  if (angle < 0) {\r\n    angle += PI2;\r\n  }\r\n  if (angle >= startAngle && angle <= endAngle || angle + PI2 >= startAngle && angle + PI2 <= endAngle) {\r\n    // Project point is on the arc.\r\n    out[0] = ox;\r\n    out[1] = oy;\r\n    return d - r;\r\n  }\r\n  var x1 = r * Math.cos(startAngle) + cx;\r\n  var y1 = r * Math.sin(startAngle) + cy;\r\n  var x2 = r * Math.cos(endAngle) + cx;\r\n  var y2 = r * Math.sin(endAngle) + cy;\r\n  var d1 = (x1 - x) * (x1 - x) + (y1 - y) * (y1 - y);\r\n  var d2 = (x2 - x) * (x2 - x) + (y2 - y) * (y2 - y);\r\n  if (d1 < d2) {\r\n    out[0] = x1;\r\n    out[1] = y1;\r\n    return Math.sqrt(d1);\r\n  } else {\r\n    out[0] = x2;\r\n    out[1] = y2;\r\n    return Math.sqrt(d2);\r\n  }\r\n}\r\nfunction projectPointToLine(x1, y1, x2, y2, x, y, out, limitToEnds) {\r\n  var dx = x - x1;\r\n  var dy = y - y1;\r\n  var dx1 = x2 - x1;\r\n  var dy1 = y2 - y1;\r\n  var lineLen = Math.sqrt(dx1 * dx1 + dy1 * dy1);\r\n  dx1 /= lineLen;\r\n  dy1 /= lineLen;\r\n  // dot product\r\n  var projectedLen = dx * dx1 + dy * dy1;\r\n  var t = projectedLen / lineLen;\r\n  if (limitToEnds) {\r\n    t = Math.min(Math.max(t, 0), 1);\r\n  }\r\n  t *= lineLen;\r\n  var ox = out[0] = x1 + t * dx1;\r\n  var oy = out[1] = y1 + t * dy1;\r\n  return Math.sqrt((ox - x) * (ox - x) + (oy - y) * (oy - y));\r\n}\r\nfunction projectPointToRect(x1, y1, width, height, x, y, out) {\r\n  if (width < 0) {\r\n    x1 = x1 + width;\r\n    width = -width;\r\n  }\r\n  if (height < 0) {\r\n    y1 = y1 + height;\r\n    height = -height;\r\n  }\r\n  var x2 = x1 + width;\r\n  var y2 = y1 + height;\r\n  var ox = out[0] = Math.min(Math.max(x, x1), x2);\r\n  var oy = out[1] = Math.min(Math.max(y, y1), y2);\r\n  return Math.sqrt((ox - x) * (ox - x) + (oy - y) * (oy - y));\r\n}\r\nvar tmpPt = [];\r\nfunction nearestPointOnRect(pt, rect, out) {\r\n  var dist = projectPointToRect(rect.x, rect.y, rect.width, rect.height, pt.x, pt.y, tmpPt);\r\n  out.set(tmpPt[0], tmpPt[1]);\r\n  return dist;\r\n}\r\n/**\r\n * Calculate min distance corresponding point.\r\n * This method won't evaluate if point is in the path.\r\n */\r\nfunction nearestPointOnPath(pt, path, out) {\r\n  var xi = 0;\r\n  var yi = 0;\r\n  var x0 = 0;\r\n  var y0 = 0;\r\n  var x1;\r\n  var y1;\r\n  var minDist = Infinity;\r\n  var data = path.data;\r\n  var x = pt.x;\r\n  var y = pt.y;\r\n  for (var i = 0; i < data.length;) {\r\n    var cmd = data[i++];\r\n    if (i === 1) {\r\n      xi = data[i];\r\n      yi = data[i + 1];\r\n      x0 = xi;\r\n      y0 = yi;\r\n    }\r\n    var d = minDist;\r\n    switch (cmd) {\r\n      case CMD.M:\r\n        // moveTo 命令重新创建一个新的 subpath, 并且更新新的起点\r\n        // 在 closePath 的时候使用\r\n        x0 = data[i++];\r\n        y0 = data[i++];\r\n        xi = x0;\r\n        yi = y0;\r\n        break;\r\n      case CMD.L:\r\n        d = projectPointToLine(xi, yi, data[i], data[i + 1], x, y, tmpPt, true);\r\n        xi = data[i++];\r\n        yi = data[i++];\r\n        break;\r\n      case CMD.C:\r\n        d = cubicProjectPoint(xi, yi, data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1], x, y, tmpPt);\r\n        xi = data[i++];\r\n        yi = data[i++];\r\n        break;\r\n      case CMD.Q:\r\n        d = quadraticProjectPoint(xi, yi, data[i++], data[i++], data[i], data[i + 1], x, y, tmpPt);\r\n        xi = data[i++];\r\n        yi = data[i++];\r\n        break;\r\n      case CMD.A:\r\n        // TODO Arc 判断的开销比较大\r\n        var cx = data[i++];\r\n        var cy = data[i++];\r\n        var rx = data[i++];\r\n        var ry = data[i++];\r\n        var theta = data[i++];\r\n        var dTheta = data[i++];\r\n        // TODO Arc 旋转\r\n        i += 1;\r\n        var anticlockwise = !!(1 - data[i++]);\r\n        x1 = Math.cos(theta) * rx + cx;\r\n        y1 = Math.sin(theta) * ry + cy;\r\n        // 不是直接使用 arc 命令\r\n        if (i <= 1) {\r\n          // 第一个命令起点还未定义\r\n          x0 = x1;\r\n          y0 = y1;\r\n        }\r\n        // zr 使用scale来模拟椭圆, 这里也对x做一定的缩放\r\n        var _x = (x - cx) * ry / rx + cx;\r\n        d = projectPointToArc(cx, cy, ry, theta, theta + dTheta, anticlockwise, _x, y, tmpPt);\r\n        xi = Math.cos(theta + dTheta) * rx + cx;\r\n        yi = Math.sin(theta + dTheta) * ry + cy;\r\n        break;\r\n      case CMD.R:\r\n        x0 = xi = data[i++];\r\n        y0 = yi = data[i++];\r\n        var width = data[i++];\r\n        var height = data[i++];\r\n        d = projectPointToRect(x0, y0, width, height, x, y, tmpPt);\r\n        break;\r\n      case CMD.Z:\r\n        d = projectPointToLine(xi, yi, x0, y0, x, y, tmpPt, true);\r\n        xi = x0;\r\n        yi = y0;\r\n        break;\r\n    }\r\n    if (d < minDist) {\r\n      minDist = d;\r\n      out.set(tmpPt[0], tmpPt[1]);\r\n    }\r\n  }\r\n  return minDist;\r\n}\r\n// Temporal variable for intermediate usage.\r\nvar pt0 = new Point();\r\nvar pt1 = new Point();\r\nvar pt2 = new Point();\r\nvar dir = new Point();\r\nvar dir2 = new Point();\r\n/**\r\n * Calculate a proper guide line based on the label position and graphic element definition\r\n * @param label\r\n * @param labelRect\r\n * @param target\r\n * @param targetRect\r\n */\r\nexport function updateLabelLinePoints(target, labelLineModel) {\r\n  if (!target) {\r\n    return;\r\n  }\r\n  var labelLine = target.getTextGuideLine();\r\n  var label = target.getTextContent();\r\n  // Needs to create text guide in each charts.\r\n  if (!(label && labelLine)) {\r\n    return;\r\n  }\r\n  var labelGuideConfig = target.textGuideLineConfig || {};\r\n  var points = [[0, 0], [0, 0], [0, 0]];\r\n  var searchSpace = labelGuideConfig.candidates || DEFAULT_SEARCH_SPACE;\r\n  var labelRect = label.getBoundingRect().clone();\r\n  labelRect.applyTransform(label.getComputedTransform());\r\n  var minDist = Infinity;\r\n  var anchorPoint = labelGuideConfig.anchor;\r\n  var targetTransform = target.getComputedTransform();\r\n  var targetInversedTransform = targetTransform && invert([], targetTransform);\r\n  var len = labelLineModel.get('length2') || 0;\r\n  if (anchorPoint) {\r\n    pt2.copy(anchorPoint);\r\n  }\r\n  for (var i = 0; i < searchSpace.length; i++) {\r\n    var candidate = searchSpace[i];\r\n    getCandidateAnchor(candidate, 0, labelRect, pt0, dir);\r\n    Point.scaleAndAdd(pt1, pt0, dir, len);\r\n    // Transform to target coord space.\r\n    pt1.transform(targetInversedTransform);\r\n    // Note: getBoundingRect will ensure the `path` being created.\r\n    var boundingRect = target.getBoundingRect();\r\n    var dist = anchorPoint ? anchorPoint.distance(pt1) : target instanceof Path ? nearestPointOnPath(pt1, target.path, pt2) : nearestPointOnRect(pt1, boundingRect, pt2);\r\n    // TODO pt2 is in the path\r\n    if (dist < minDist) {\r\n      minDist = dist;\r\n      // Transform back to global space.\r\n      pt1.transform(targetTransform);\r\n      pt2.transform(targetTransform);\r\n      pt2.toArray(points[0]);\r\n      pt1.toArray(points[1]);\r\n      pt0.toArray(points[2]);\r\n    }\r\n  }\r\n  limitTurnAngle(points, labelLineModel.get('minTurnAngle'));\r\n  labelLine.setShape({\r\n    points: points\r\n  });\r\n}\r\n// Temporal variable for the limitTurnAngle function\r\nvar tmpArr = [];\r\nvar tmpProjPoint = new Point();\r\n/**\r\n * Reduce the line segment attached to the label to limit the turn angle between two segments.\r\n * @param linePoints\r\n * @param minTurnAngle Radian of minimum turn angle. 0 - 180\r\n */\r\nexport function limitTurnAngle(linePoints, minTurnAngle) {\r\n  if (!(minTurnAngle <= 180 && minTurnAngle > 0)) {\r\n    return;\r\n  }\r\n  minTurnAngle = minTurnAngle / 180 * Math.PI;\r\n  // The line points can be\r\n  //      /pt1----pt2 (label)\r\n  //     /\r\n  // pt0/\r\n  pt0.fromArray(linePoints[0]);\r\n  pt1.fromArray(linePoints[1]);\r\n  pt2.fromArray(linePoints[2]);\r\n  Point.sub(dir, pt0, pt1);\r\n  Point.sub(dir2, pt2, pt1);\r\n  var len1 = dir.len();\r\n  var len2 = dir2.len();\r\n  if (len1 < 1e-3 || len2 < 1e-3) {\r\n    return;\r\n  }\r\n  dir.scale(1 / len1);\r\n  dir2.scale(1 / len2);\r\n  var angleCos = dir.dot(dir2);\r\n  var minTurnAngleCos = Math.cos(minTurnAngle);\r\n  if (minTurnAngleCos < angleCos) {\r\n    // Smaller than minTurnAngle\r\n    // Calculate project point of pt0 on pt1-pt2\r\n    var d = projectPointToLine(pt1.x, pt1.y, pt2.x, pt2.y, pt0.x, pt0.y, tmpArr, false);\r\n    tmpProjPoint.fromArray(tmpArr);\r\n    // Calculate new projected length with limited minTurnAngle and get the new connect point\r\n    tmpProjPoint.scaleAndAdd(dir2, d / Math.tan(Math.PI - minTurnAngle));\r\n    // Limit the new calculated connect point between pt1 and pt2.\r\n    var t = pt2.x !== pt1.x ? (tmpProjPoint.x - pt1.x) / (pt2.x - pt1.x) : (tmpProjPoint.y - pt1.y) / (pt2.y - pt1.y);\r\n    if (isNaN(t)) {\r\n      return;\r\n    }\r\n    if (t < 0) {\r\n      Point.copy(tmpProjPoint, pt1);\r\n    } else if (t > 1) {\r\n      Point.copy(tmpProjPoint, pt2);\r\n    }\r\n    tmpProjPoint.toArray(linePoints[1]);\r\n  }\r\n}\r\n/**\r\n * Limit the angle of line and the surface\r\n * @param maxSurfaceAngle Radian of minimum turn angle. 0 - 180. 0 is same direction to normal. 180 is opposite\r\n */\r\nexport function limitSurfaceAngle(linePoints, surfaceNormal, maxSurfaceAngle) {\r\n  if (!(maxSurfaceAngle <= 180 && maxSurfaceAngle > 0)) {\r\n    return;\r\n  }\r\n  maxSurfaceAngle = maxSurfaceAngle / 180 * Math.PI;\r\n  pt0.fromArray(linePoints[0]);\r\n  pt1.fromArray(linePoints[1]);\r\n  pt2.fromArray(linePoints[2]);\r\n  Point.sub(dir, pt1, pt0);\r\n  Point.sub(dir2, pt2, pt1);\r\n  var len1 = dir.len();\r\n  var len2 = dir2.len();\r\n  if (len1 < 1e-3 || len2 < 1e-3) {\r\n    return;\r\n  }\r\n  dir.scale(1 / len1);\r\n  dir2.scale(1 / len2);\r\n  var angleCos = dir.dot(surfaceNormal);\r\n  var maxSurfaceAngleCos = Math.cos(maxSurfaceAngle);\r\n  if (angleCos < maxSurfaceAngleCos) {\r\n    // Calculate project point of pt0 on pt1-pt2\r\n    var d = projectPointToLine(pt1.x, pt1.y, pt2.x, pt2.y, pt0.x, pt0.y, tmpArr, false);\r\n    tmpProjPoint.fromArray(tmpArr);\r\n    var HALF_PI = Math.PI / 2;\r\n    var angle2 = Math.acos(dir2.dot(surfaceNormal));\r\n    var newAngle = HALF_PI + angle2 - maxSurfaceAngle;\r\n    if (newAngle >= HALF_PI) {\r\n      // parallel\r\n      Point.copy(tmpProjPoint, pt2);\r\n    } else {\r\n      // Calculate new projected length with limited minTurnAngle and get the new connect point\r\n      tmpProjPoint.scaleAndAdd(dir2, d / Math.tan(Math.PI / 2 - newAngle));\r\n      // Limit the new calculated connect point between pt1 and pt2.\r\n      var t = pt2.x !== pt1.x ? (tmpProjPoint.x - pt1.x) / (pt2.x - pt1.x) : (tmpProjPoint.y - pt1.y) / (pt2.y - pt1.y);\r\n      if (isNaN(t)) {\r\n        return;\r\n      }\r\n      if (t < 0) {\r\n        Point.copy(tmpProjPoint, pt1);\r\n      } else if (t > 1) {\r\n        Point.copy(tmpProjPoint, pt2);\r\n      }\r\n    }\r\n    tmpProjPoint.toArray(linePoints[1]);\r\n  }\r\n}\r\nfunction setLabelLineState(labelLine, ignore, stateName, stateModel) {\r\n  var isNormal = stateName === 'normal';\r\n  var stateObj = isNormal ? labelLine : labelLine.ensureState(stateName);\r\n  // Make sure display.\r\n  stateObj.ignore = ignore;\r\n  // Set smooth\r\n  var smooth = stateModel.get('smooth');\r\n  if (smooth && smooth === true) {\r\n    smooth = 0.3;\r\n  }\r\n  stateObj.shape = stateObj.shape || {};\r\n  if (smooth > 0) {\r\n    stateObj.shape.smooth = smooth;\r\n  }\r\n  var styleObj = stateModel.getModel('lineStyle').getLineStyle();\r\n  isNormal ? labelLine.useStyle(styleObj) : stateObj.style = styleObj;\r\n}\r\nfunction buildLabelLinePath(path, shape) {\r\n  var smooth = shape.smooth;\r\n  var points = shape.points;\r\n  if (!points) {\r\n    return;\r\n  }\r\n  path.moveTo(points[0][0], points[0][1]);\r\n  if (smooth > 0 && points.length >= 3) {\r\n    var len1 = vector.dist(points[0], points[1]);\r\n    var len2 = vector.dist(points[1], points[2]);\r\n    if (!len1 || !len2) {\r\n      path.lineTo(points[1][0], points[1][1]);\r\n      path.lineTo(points[2][0], points[2][1]);\r\n      return;\r\n    }\r\n    var moveLen = Math.min(len1, len2) * smooth;\r\n    var midPoint0 = vector.lerp([], points[1], points[0], moveLen / len1);\r\n    var midPoint2 = vector.lerp([], points[1], points[2], moveLen / len2);\r\n    var midPoint1 = vector.lerp([], midPoint0, midPoint2, 0.5);\r\n    path.bezierCurveTo(midPoint0[0], midPoint0[1], midPoint0[0], midPoint0[1], midPoint1[0], midPoint1[1]);\r\n    path.bezierCurveTo(midPoint2[0], midPoint2[1], midPoint2[0], midPoint2[1], points[2][0], points[2][1]);\r\n  } else {\r\n    for (var i = 1; i < points.length; i++) {\r\n      path.lineTo(points[i][0], points[i][1]);\r\n    }\r\n  }\r\n}\r\n/**\r\n * Create a label line if necessary and set it's style.\r\n */\r\nexport function setLabelLineStyle(targetEl, statesModels, defaultStyle) {\r\n  var labelLine = targetEl.getTextGuideLine();\r\n  var label = targetEl.getTextContent();\r\n  if (!label) {\r\n    // Not show label line if there is no label.\r\n    if (labelLine) {\r\n      targetEl.removeTextGuideLine();\r\n    }\r\n    return;\r\n  }\r\n  var normalModel = statesModels.normal;\r\n  var showNormal = normalModel.get('show');\r\n  var labelIgnoreNormal = label.ignore;\r\n  for (var i = 0; i < DISPLAY_STATES.length; i++) {\r\n    var stateName = DISPLAY_STATES[i];\r\n    var stateModel = statesModels[stateName];\r\n    var isNormal = stateName === 'normal';\r\n    if (stateModel) {\r\n      var stateShow = stateModel.get('show');\r\n      var isLabelIgnored = isNormal ? labelIgnoreNormal : retrieve2(label.states[stateName] && label.states[stateName].ignore, labelIgnoreNormal);\r\n      if (isLabelIgnored // Not show when label is not shown in this state.\r\n      || !retrieve2(stateShow, showNormal) // Use normal state by default if not set.\r\n      ) {\r\n        var stateObj = isNormal ? labelLine : labelLine && labelLine.states[stateName];\r\n        if (stateObj) {\r\n          stateObj.ignore = true;\r\n        }\r\n        if (!!labelLine) {\r\n          setLabelLineState(labelLine, true, stateName, stateModel);\r\n        }\r\n        continue;\r\n      }\r\n      // Create labelLine if not exists\r\n      if (!labelLine) {\r\n        labelLine = new Polyline();\r\n        targetEl.setTextGuideLine(labelLine);\r\n        // Reset state of normal because it's new created.\r\n        // NOTE: NORMAL should always been the first!\r\n        if (!isNormal && (labelIgnoreNormal || !showNormal)) {\r\n          setLabelLineState(labelLine, true, 'normal', statesModels.normal);\r\n        }\r\n        // Use same state proxy.\r\n        if (targetEl.stateProxy) {\r\n          labelLine.stateProxy = targetEl.stateProxy;\r\n        }\r\n      }\r\n      setLabelLineState(labelLine, false, stateName, stateModel);\r\n    }\r\n  }\r\n  if (labelLine) {\r\n    defaults(labelLine.style, defaultStyle);\r\n    // Not fill.\r\n    labelLine.style.fill = null;\r\n    var showAbove = normalModel.get('showAbove');\r\n    var labelLineConfig = targetEl.textGuideLineConfig = targetEl.textGuideLineConfig || {};\r\n    labelLineConfig.showAbove = showAbove || false;\r\n    // Custom the buildPath.\r\n    labelLine.buildPath = buildLabelLinePath;\r\n  }\r\n}\r\nexport function getLabelLineStatesModels(itemModel, labelLineName) {\r\n  labelLineName = labelLineName || 'labelLine';\r\n  var statesModels = {\r\n    normal: itemModel.getModel(labelLineName)\r\n  };\r\n  for (var i = 0; i < SPECIAL_STATES.length; i++) {\r\n    var stateName = SPECIAL_STATES[i];\r\n    statesModels[stateName] = itemModel.getModel([stateName, labelLineName]);\r\n  }\r\n  return statesModels;\r\n}"],
  "mappings": "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",
  "names": ["resultItem", "coordDim", "resultDimIdx", "i", "map", "CoordSysInfo", "dist"]
}
